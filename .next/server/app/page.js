(()=>{var e={};e.id=931,e.ids=[931],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},75467:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>l,pages:()=>f,routeModule:()=>b,tree:()=>o}),t(83164),t(11506),t(19644),t(35866);var a=t(23191),n=t(88716),s=t(37922),i=t.n(s),d=t(95231),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);t.d(r,c);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,83164)),"E:\\Programming\\Intekhaab\\admin\\app\\page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,11506)),"E:\\Programming\\Intekhaab\\admin\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,19644)),"E:\\Programming\\Intekhaab\\admin\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],f=["E:\\Programming\\Intekhaab\\admin\\app\\page.tsx"],l="/page",u={require:t,loadChunk:()=>Promise.resolve()},b=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},18421:(e,r,t)=>{let a={"01a038b941520912faba054f25a519491687433d":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.decrypt),"31c603db583e6f4979512039e3a77f9ed93048f0":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.admindecrypt),"35d4c1441f5f064fdebf725c84a6fb8128d8a81c":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.adminencrypt),"37a5a71dc1211cb496f250b7079bb409ff231298":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.doLogin),"6e3a33b373d25097280279d1c091fc56c15c844f":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.encrypt),"722ed65feea5b21261bbd2c76a7f077b1d509037":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.updateSession),"796f752e6ac3f9cff407e402a73d9720c3fdb593":()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.getSession),a3d3abb1e9e0d23ce2919fdc20b5d51b8dc3863b:()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.validateSession),beddca5024040d472c74a752bd260aad0d5e71ed:()=>Promise.resolve().then(t.bind(t,89204)).then(e=>e.doLogout)};async function n(e,...r){return(await a[e]()).apply(null,r)}e.exports={"01a038b941520912faba054f25a519491687433d":n.bind(null,"01a038b941520912faba054f25a519491687433d"),"31c603db583e6f4979512039e3a77f9ed93048f0":n.bind(null,"31c603db583e6f4979512039e3a77f9ed93048f0"),"35d4c1441f5f064fdebf725c84a6fb8128d8a81c":n.bind(null,"35d4c1441f5f064fdebf725c84a6fb8128d8a81c"),"37a5a71dc1211cb496f250b7079bb409ff231298":n.bind(null,"37a5a71dc1211cb496f250b7079bb409ff231298"),"6e3a33b373d25097280279d1c091fc56c15c844f":n.bind(null,"6e3a33b373d25097280279d1c091fc56c15c844f"),"722ed65feea5b21261bbd2c76a7f077b1d509037":n.bind(null,"722ed65feea5b21261bbd2c76a7f077b1d509037"),"796f752e6ac3f9cff407e402a73d9720c3fdb593":n.bind(null,"796f752e6ac3f9cff407e402a73d9720c3fdb593"),a3d3abb1e9e0d23ce2919fdc20b5d51b8dc3863b:n.bind(null,"a3d3abb1e9e0d23ce2919fdc20b5d51b8dc3863b"),beddca5024040d472c74a752bd260aad0d5e71ed:n.bind(null,"beddca5024040d472c74a752bd260aad0d5e71ed")}},49705:(e,r,t)=>{Promise.resolve().then(t.bind(t,91290))},36297:(e,r,t)=>{"use strict";t.d(r,{Gg:()=>i,Qk:()=>s,XR:()=>n}),t(15424);var a=t(46242);(0,a.$)("722ed65feea5b21261bbd2c76a7f077b1d509037"),(0,a.$)("6e3a33b373d25097280279d1c091fc56c15c844f"),(0,a.$)("35d4c1441f5f064fdebf725c84a6fb8128d8a81c"),(0,a.$)("01a038b941520912faba054f25a519491687433d"),(0,a.$)("31c603db583e6f4979512039e3a77f9ed93048f0");var n=(0,a.$)("37a5a71dc1211cb496f250b7079bb409ff231298"),s=(0,a.$)("beddca5024040d472c74a752bd260aad0d5e71ed"),i=(0,a.$)("796f752e6ac3f9cff407e402a73d9720c3fdb593");(0,a.$)("a3d3abb1e9e0d23ce2919fdc20b5d51b8dc3863b")},91290:(e,r,t)=>{"use strict";t.d(r,{CardWithForm:()=>p});var a=t(10326),n=t(17577),s=t(90772),i=t(33071),d=t(54432),c=t(31048),o=t(35047),f=t(36297),l=t(84941),u=t(44099),b=t(85999);function p(){let e=(0,o.useRouter)(),[r,t]=n.useState(""),[p,h]=n.useState(""),[x,m]=n.useState(!1);return n.useEffect(()=>{t(""),h("")},[]),(0,a.jsxs)(i.Zb,{className:"w-[350px]",children:[(0,a.jsxs)(i.Ol,{children:[a.jsx(i.ll,{children:"Intekhaab"}),a.jsx(i.SZ,{children:"Simple & Secure Elections"})]}),a.jsx(i.aY,{children:a.jsx("form",{onSubmit:e=>e.preventDefault(),children:(0,a.jsxs)("div",{className:"grid w-full items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[a.jsx(c._,{htmlFor:"username",children:"Phone"}),a.jsx(d.I,{id:"username",placeholder:"Mobile Number",value:r,onChange:e=>t(e.target.value),disabled:x})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[a.jsx(c._,{htmlFor:"password",children:"Date Of Birth"}),a.jsx(l.d,{onDateChange:e=>{console.log(e),h(e.toISOString())}})]})]})})}),(0,a.jsxs)(i.eW,{className:"flex justify-left gap-2",children:[a.jsx(s.z,{onClick:function(t){t.preventDefault(),m(!0),u.Z.post("/api/voter",{phone:r,dob:new Date(p).toLocaleDateString("en-GB").replace(/\//g,"-")}).then(r=>!1===r.data.verified?(b.A.error("User not verified!"),e.push("/"),Promise.reject("User not verified")):(0,f.XR)(r.data)).then(()=>{console.log("Login successful"),e.push("/user")}).catch(e=>{console.error("Login failed:",e),e.response&&e.response.data&&e.response.data.message?b.A.error(e.response.data.message):b.A.error(e)}).finally(()=>{m(!1)})},disabled:x,children:x?"Loading...":"Login"}),a.jsx(s.z,{variant:"ghost",className:"underline text-xs text-gray-400",onClick:()=>e.push("/register"),children:"Register"})]})]})}},89204:(e,r,t)=>{"use strict";t.r(r),t.d(r,{admindecrypt:()=>h,adminencrypt:()=>b,decrypt:()=>p,doLogin:()=>x,doLogout:()=>m,encrypt:()=>f,getSession:()=>g,updateSession:()=>y,validateSession:()=>v});var a=t(27745);t(26461);var n=t(95801),s=t(53973),i=t(6388),d=t(85723);let c=process.env.SECRET_KEY,o=new TextEncoder().encode(c);async function f(e){return await new n.SignJWT(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("1h").sign(o)}let l=process.env.ADMIN_SECRET_KEY,u=new TextEncoder().encode(l);async function b(e){return await new n.SignJWT(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("5h").sign(u)}async function p(e){try{let{payload:r}=await (0,n.jwtVerify)(e,o,{algorithms:["HS256"]});return r}catch(e){if("ERR_JWT_EXPIRED"===e.code)throw Error("Token has expired");throw Error("Token verification failed")}}async function h(e){try{let{payload:r}=await (0,n.jwtVerify)(e,u,{algorithms:["HS256"]});return r}catch(e){if("ERR_JWT_EXPIRED"===e.code)throw Error("Admin token has expired");throw Error("Admin token verification failed")}}async function x(e){try{let r=new Date(Date.now()+36e5),t=await f({user:e,expires:r});return(0,s.cookies)().set("session",t,{expires:r,httpOnly:!0}),"Success"}catch(e){return e.message}}async function m(){return(0,s.cookies)().set("session","",{expires:new Date(0)}),"Logged out"}async function g(){let e=s.cookies().get("session")?.value;return e?await p(e):null}async function v(e){try{return await p(e)}catch(e){return null}}async function y(e){let r=e.cookies.get("session")?.value;if(!r)return;let t=await p(r);t.expires=new Date(Date.now()+1e4);let a=i.NextResponse.next();return a.cookies.set({name:"session",value:await f(t),httpOnly:!0,expires:t.expires}),a}(0,d.ensureServerEntryExports)([f,b,p,h,x,m,g,v,y]),(0,a.registerServerReference)("6e3a33b373d25097280279d1c091fc56c15c844f",f),(0,a.registerServerReference)("35d4c1441f5f064fdebf725c84a6fb8128d8a81c",b),(0,a.registerServerReference)("01a038b941520912faba054f25a519491687433d",p),(0,a.registerServerReference)("31c603db583e6f4979512039e3a77f9ed93048f0",h),(0,a.registerServerReference)("37a5a71dc1211cb496f250b7079bb409ff231298",x),(0,a.registerServerReference)("beddca5024040d472c74a752bd260aad0d5e71ed",m),(0,a.registerServerReference)("796f752e6ac3f9cff407e402a73d9720c3fdb593",g),(0,a.registerServerReference)("a3d3abb1e9e0d23ce2919fdc20b5d51b8dc3863b",v),(0,a.registerServerReference)("722ed65feea5b21261bbd2c76a7f077b1d509037",y)},83164:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var a=t(19510),n=t(68570);let s=(0,n.createProxy)(String.raw`E:\Programming\Intekhaab\admin\app\login.tsx`),{__esModule:i,$$typeof:d}=s;s.default;let c=(0,n.createProxy)(String.raw`E:\Programming\Intekhaab\admin\app\login.tsx#CardWithForm`);function o(){return a.jsx("div",{className:"flex w-full justify-center items-center min-h-screen",children:a.jsx(c,{})})}}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,992,167,759,245,113,589],()=>t(75467));module.exports=a})();