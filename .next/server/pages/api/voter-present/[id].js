"use strict";(()=>{var e={};e.id=590,e.ids=[590],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},92824:e=>{e.exports=require("next/server")},16689:e=>{e.exports=require("react")},99369:e=>{e.exports=import("jose")},98689:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{config:()=>d,default:()=>u,routeModule:()=>l});var o=t(71802),s=t(47153),i=t(56249),a=t(4818),c=e([a]);a=(c.then?(await c)():c)[0];let u=(0,i.l)(a,"default"),d=(0,i.l)(a,"config"),l=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/voter-present/[id]",pathname:"/api/voter-present/[id]",bundlePath:"",filename:""},userland:a});n()}catch(e){n(e)}})},55320:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.d(r,{je:()=>a});var o=t(99369);t(53121),t(92824);var s=e([o]);o=(s.then?(await s)():s)[0];let c=process.env.SECRET_KEY,u=new TextEncoder().encode(c),d=process.env.ADMIN_SECRET_KEY;async function i(e){try{let{payload:r}=await (0,o.jwtVerify)(e,u,{algorithms:["HS256"]});return r}catch(e){if("ERR_JWT_EXPIRED"===e.code)throw Error("Token has expired");throw Error("Token verification failed")}}async function a(e){try{return await i(e)}catch(e){return null}}new TextEncoder().encode(d),n()}catch(e){n(e)}})},8614:(e,r,t)=>{t.d(r,{Z:()=>i});var n=t(11185),o=t.n(n);let s=new(o()).Schema({voter_id:{type:String,required:!0},name:{type:String,required:!0},phone:{type:String,required:!0},date_of_birth:{type:String,required:!0},unit:{type:String,required:!0},area:{type:String,required:!0},verified:{type:Boolean,required:!0},present:{type:Boolean,required:!0},voted:{type:Boolean,required:!0}}),i=o().models.Voter||o().model("Voter",s)},4818:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{default:()=>c});var o=t(60578),s=t(8614),i=t(55320),a=e([i]);async function c(e,r){if("GET"!==e.method)return console.log("Invalid request method:",e.method),r.status(405).json({message:"Method not allowed"});{if(!await (0,i.je)(e.headers.cookie?.split("; ").find(e=>e.startsWith("session="))?.split("=")[1]))return r.status(401).json({error:"Unauthorized"});let{id:t}=e.query;if(!t)return console.log("ID is missing in the request"),r.status(400).json({message:"ID is required"});try{await (0,o.v)();let e=await s.Z.findOne({voter_id:t});if(!e)return console.log("Voter not found with id:",t),r.status(404).json({message:"Voter not found"});return r.status(200).json({present:e.present})}catch(e){return console.error("Error checking voter:",e),r.status(500).json({message:"Internal server error"})}}}i=(a.then?(await a)():a)[0],n()}catch(e){n(e)}})},60578:(e,r,t)=>{t.d(r,{v:()=>a});var n=t(11185),o=t.n(n);let s="mongodb+srv://trytauseef:t7otzsHqJg0UlWLL@securecluster.3ts5v.mongodb.net/?retryWrites=true&w=majority&appName=SecureCluster";if(!s)throw Error("Please define the NEXT_PUBLIC_MONGODB_URI environment variable inside .env.local");let i=global.mongoose;async function a(){if(i.conn)return i.conn;i.promise||(i.promise=o().connect(s,{useNewUrlParser:!0,useUnifiedTopology:!0}).then(e=>e));try{i.conn=await i.promise}catch(e){throw console.error("Database connection failed:",e),Error("Database connection failed")}return i.conn}i||(i=global.mongoose={conn:null,promise:null})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[643],()=>t(98689));module.exports=n})();